<!DOCTYPE html>
<html>
    <head>        
        <title>Student Form</title>
        <style>
            table,
            th,
            td {
                border: 1px solid black;
                border-collapse: collapse;
                text-align: left;
            }

            tr:hover {
                background-color: rgb(120, 161, 171);
                color: white;
            }

            tr:nth-child(even) {
                background-color: #929292;
            }
            tr:hover:nth-child(even) {
                background-color:  rgb(120, 161, 171);
            }

            table {
                width: 100%;
            }
        </style>
    </head>

    <body>

        <table id="tableID">
            <thead>
                <th>StudentID</th>
                <th>Name</th>
                <th>Last Name</th>
                <th>Birthday</th>
                <th>Major</th>
                <th>University</th>
                <th>Actions</th>
            </thead>
            <tbody id="tablebody"></tbody>
        </table>

        <form>
            <input type="number" placeholder="Enter ID" id="idInput"  min = 0 max = 99999999 required  >
            <input type="text" placeholder="Enter name" id="nameInput"required>
            <input type ="text" placeholder="Enter last name" id="lastNameInput" required>
            <input type ="date" id="bdayInput" min = "1940-12-29" max = "2008-12-29"required>
            <input type="text" placeholder="Enter Major" id="majorInput" required>
            <input type="text" placeholder="Enter University" id="uniInput" required>
            <input type="submit" value="Add Student" id="submitButton" >
        </form>

        <script>
            // declaring
            const inputID = document.getElementById('idInput');
            const inputName = document.getElementById('nameInput');
            const lastNameInput= document.getElementById('lastNameInput');
            const bdayInput = document.getElementById('bdayInput');
            const majorInput = document.getElementById('majorInput');
            const uniInput = document.getElementById('uniInput');
            const tableBody = document.getElementById('tablebody');
            
            let flag = false;
            let newIndex = -1;

            function studentInfo() {
                this.ID = 0 ;
                this.name = '';
                this.lastName ='';
                this.birthday=Date;
                this.major = '';
                this.uni = '';
            }

            var students = [
            { name: "Bahar", lastName: "Khouban", ID: 32912023, birthday: "2000-08-19", major: "CS", uni: "Behesthi"},
                { name: "Rojin", lastName: "LN", ID: 2931, birthday: "1380-08-13", major: "CS", uni: "Behesthi"}
            ];

            //functions 

            function updateTable(){

                tableBody.innerHTML = "";
                students.forEach(function(item, index) {
                    let row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.ID}</td>
                        <td>${item.name}</td>
                        <td>${item.lastName}</td>
                        <td>${item.birthday}</td>
                        <td>${item.major}</td>
                        <td>${item.uni}</td>
                        <td><input type="button" onclick="removeRow(${item.ID});" value="Remove">
                        <input type="button" value="Update" onclick="(!flag)? writeForm(${index}) : addStudent();"></td>
                    `;
                    tableBody.appendChild(row);
                });
            }       

            function writeForm(index) {
                document.getElementById('submitButton').value="Update";
                inputID.value = students[index].ID;
                inputName.value = students[index].name;
                lastNameInput.value = students[index].lastName;
                bdayInput.value = students[index].birthday;
                majorInput.value = students[index].major;
                uniInput.value = students[index].uni;

                newIndex = index; 
                flag = true;
            }

            function removeRow(StudentID) {
                let index = students.findIndex(student => student.ID === StudentID);
                students.splice(index, 1);
                updateTable();
            }

            function addStudent() {

                var newStu = new studentInfo();
                newStu.ID = parseInt(inputID.value);
                newStu.name = inputName.value;
                newStu.lastName = lastNameInput.value;
                newStu.birthday = bdayInput.value;
                newStu.major = majorInput.value; 
                newStu.uni = uniInput.value;
                
                if (!flag)
                    students.push(newStu);

                else {
                    students[newIndex].ID = newStu.ID;
                    students[newIndex].name = newStu.name;
                    students[newIndex].lastName = newStu.lastName;
                    students[newIndex].birthday = newStu.birthday;
                    students[newIndex].major = newStu.major;
                    students[newIndex].uni = newStu.uni;
                    flag = false;
                    document.getElementById('submitButton').value="Add Student";

                }
                
                updateTable();
                document.querySelector('form').reset();
            }

            // submit

            document.querySelector('form').addEventListener('submit', function(event){
                event.preventDefault(); 
                addStudent();
            });
            updateTable();

        </script>
    </body>
</html>
